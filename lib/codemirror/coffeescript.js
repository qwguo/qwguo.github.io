"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"object"==("undefined"==typeof module?"undefined":_typeof(module))?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){e.defineMode("coffeescript",function(e,t){function n(e){return new RegExp("^(("+e.join(")|(")+"))\\b")}function o(e,t){if(e.sol()){null===t.scope.align&&(t.scope.align=!1);var n=t.scope.offset;if(e.eatSpace()){var o=e.indentation();return o>n&&"coffee"==t.scope.type?"indent":o<n?"dedent":null}n>0&&c(e,t)}if(e.eatSpace())return null;var f=e.peek();if(e.match("####"))return e.skipToEnd(),"comment";if(e.match("###"))return t.tokenize=i,t.tokenize(e,t);if("#"===f)return e.skipToEnd(),"comment";if(e.match(/^-?[0-9\.]/,!1)){var p=!1;if(e.match(/^-?\d*\.\d+(e[\+\-]?\d+)?/i)&&(p=!0),e.match(/^-?\d+\.\d*/)&&(p=!0),e.match(/^-?\.\d+/)&&(p=!0),p)return"."==e.peek()&&e.backUp(1),"number";var y=!1;if(e.match(/^-?0x[0-9a-f]+/i)&&(y=!0),e.match(/^-?[1-9]\d*(e[\+\-]?\d+)?/)&&(y=!0),e.match(/^-?0(?![\dx])/i)&&(y=!0),y)return"number"}if(e.match(k))return t.tokenize=r(e.current(),!1,"string"),t.tokenize(e,t);if(e.match(b)){if("/"!=e.current()||e.match(/^.*\//,!1))return t.tokenize=r(e.current(),!0,"string-2"),t.tokenize(e,t);e.backUp(1)}return e.match(u)||e.match(m)?"operator":e.match(s)?"punctuation":e.match(z)?"atom":e.match(d)||t.prop&&e.match(l)?"property":e.match(v)?"keyword":e.match(l)?"variable":(e.next(),a)}function r(e,n,r){return function(i,f){for(;!i.eol();)if(i.eatWhile(/[^'"\/\\]/),i.eat("\\")){if(i.next(),n&&i.eol())return r}else{if(i.match(e))return f.tokenize=o,r;i.eat(/['"\/]/)}return n&&(t.singleLineStringErrors?r=a:f.tokenize=o),r}}function i(e,t){for(;!e.eol();){if(e.eatWhile(/[^#]/),e.match("###")){t.tokenize=o;break}e.eatWhile("#")}return"comment"}function f(t,n,o){o=o||"coffee";for(var r=0,i=!1,f=null,c=n.scope;c;c=c.prev)if("coffee"===c.type||"}"==c.type){r=c.offset+e.indentUnit;break}"coffee"!==o?(i=null,f=t.column()+t.current().length):n.scope.align&&(n.scope.align=!1),n.scope={offset:r,type:o,prev:n.scope,align:i,alignOffset:f}}function c(e,t){if(t.scope.prev){if("coffee"===t.scope.type){for(var n=e.indentation(),o=!1,r=t.scope;r;r=r.prev)if(n===r.offset){o=!0;break}if(!o)return!0;for(;t.scope.prev&&t.scope.offset!==n;)t.scope=t.scope.prev;return!1}return t.scope=t.scope.prev,!1}}function p(e,t){var n=t.tokenize(e,t),o=e.current();"return"===o&&(t.dedent=!0),(("->"===o||"=>"===o)&&e.eol()||"indent"===n)&&f(e,t);var r="[({".indexOf(o);if(-1!==r&&f(e,t,"])}".slice(r,r+1)),y.exec(o)&&f(e,t),"then"==o&&c(e,t),"dedent"===n&&c(e,t))return a;if(-1!==(r="])}".indexOf(o))){for(;"coffee"==t.scope.type&&t.scope.prev;)t.scope=t.scope.prev;t.scope.type==o&&(t.scope=t.scope.prev)}return t.dedent&&e.eol()&&("coffee"==t.scope.type&&t.scope.prev&&(t.scope=t.scope.prev),t.dedent=!1),n}var a="error",u=/^(?:->|=>|\+[+=]?|-[\-=]?|\*[\*=]?|\/[\/=]?|[=!]=|<[><]?=?|>>?=?|%=?|&=?|\|=?|\^=?|\~|!|\?|(or|and|\|\||&&|\?)=)/,s=/^(?:[()\[\]{},:`=;]|\.\.?\.?)/,l=/^[_A-Za-z$][_A-Za-z$0-9]*/,d=/^@[_A-Za-z$][_A-Za-z$0-9]*/,m=n(["and","or","not","is","isnt","in","instanceof","typeof"]),y=["for","while","loop","if","unless","else","switch","try","catch","finally","class"],h=["break","by","continue","debugger","delete","do","in","of","new","return","then","this","@","throw","when","until","extends"],v=n(y.concat(h));y=n(y);var k=/^('{3}|\"{3}|['\"])/,b=/^(\/{3}|\/)/,g=["Infinity","NaN","undefined","null","true","false","on","off","yes","no"],z=n(g);return{startState:function(e){return{tokenize:o,scope:{offset:e||0,type:"coffee",prev:null,align:!1},prop:!1,dedent:0}},token:function(e,t){var n=null===t.scope.align&&t.scope;n&&e.sol()&&(n.align=!1);var o=p(e,t);return o&&"comment"!=o&&(n&&(n.align=!0),t.prop="punctuation"==o&&"."==e.current()),o},indent:function(e,t){if(e.tokenize!=o)return 0;var n=e.scope,r=t&&"])}".indexOf(t.charAt(0))>-1;if(r)for(;"coffee"==n.type&&n.prev;)n=n.prev;var i=r&&n.type===t.charAt(0);return n.align?n.alignOffset-(i?1:0):(i?n.prev:n).offset},lineComment:"#",fold:"indent"}}),e.defineMIME("application/vnd.coffeescript","coffeescript"),e.defineMIME("text/x-coffeescript","coffeescript"),e.defineMIME("text/coffeescript","coffeescript")});